DN_25_PAUSE_IND_pol2_start_TSS_WT_KD = getNameList(PAUSE_IND_pol2_start_TSS_WT_KD, topdown = "down", prct = 25)
DN_5_PAUSE_IND_pol2_start_TSS_WT_KD = getNameList(PAUSE_IND_pol2_start_TSS_WT_KD, topdown = "down", prct = 5)
DN_1_PAUSE_IND_pol2_start_TSS_WT_KD = getNameList(PAUSE_IND_pol2_start_TSS_WT_KD, topdown = "down", prct = 1)
## GET GRANGES COORDS OF FEATURES TO PLOT AROUND
get_GR_feat = function(refGN, GNlist){
myovlp=refGN[refGN$name %in% GNlist]
return(myovlp)
}
GR_UP_25_PAUSE_IND_pol2_start_TSS_WT_KD = get_GR_feat(r6_ref_genes,UP_25_PAUSE_IND_pol2_start_TSS_WT_KD)
GR_UP_5_PAUSE_IND_pol2_start_TSS_WT_KD = get_GR_feat(r6_ref_genes,UP_5_PAUSE_IND_pol2_start_TSS_WT_KD)
GR_UP_1_PAUSE_IND_pol2_start_TSS_WT_KD= get_GR_feat(r6_ref_genes,UP_1_PAUSE_IND_pol2_start_TSS_WT_KD)
GR_CTRL_60_65_PAUSE_IND_pol2_start_TSS_WT_KD= get_GR_feat(r6_ref_genes,CTRL_60_65_PAUSE_IND_pol2_start_TSS_WT_KD)
GR_DN_25_PAUSE_IND_pol2_start_TSS_WT_KD = get_GR_feat(r6_ref_genes,DN_25_PAUSE_IND_pol2_start_TSS_WT_KD)
GR_DN_5_PAUSE_IND_pol2_start_TSS_WT_KD = get_GR_feat(r6_ref_genes,DN_5_PAUSE_IND_pol2_start_TSS_WT_KD)
GR_DN_1_PAUSE_IND_pol2_start_TSS_WT_KD = get_GR_feat(r6_ref_genes,DN_1_PAUSE_IND_pol2_start_TSS_WT_KD)
GR_list_toPlot = c("GR_UP_5_PAUSE_IND_pol2_start_TSS_WT_KD", "GR_UP_25_PAUSE_IND_pol2_start_TSS_WT_KD","GR_UP_1_PAUSE_IND_pol2_start_TSS_WT_KD", "GR_CTRL_60_65_PAUSE_IND_pol2_start_TSS_WT_KD", "GR_DN_5_PAUSE_IND_pol2_start_TSS_WT_KD", "GR_DN_25_PAUSE_IND_pol2_start_TSS_WT_KD","GR_DN_1_PAUSE_IND_pol2_start_TSS_WT_KD")
pdf(paste0(workdir,"FIGURES/AVG_PROF/RNA_POL2/AVG_RNA_POL2_PAUSE_IND_pol2_start_TSS_WT_KD.pdf"))
for(GR in GR_list_toPlot){
seqPlotSDoutliers_scaleFact(c(pol2_ctrl_N_RPGC, pol2_nelf_N_RPGC),tmp,GR,c(0,4),c(500,500),type="af",bin=10,
smooth=TRUE,spar=0.3, scalingF = c(1,1), sd=c(T,3), gnme=NA, colvec = c("#594d32", "#e09d00"))
}
dev.off()
library(ggpubr)
library(rstatix)
library("gplots")
library(textplot)
library("ggplot2")
library(dplyr)
'%ni%' = Negate('%in%')
workdir = "~/Bureau/tdefreitas_genobioinfo/PROJET_H2AV_2025/"
source(paste0(workdir,"functionR/Boxplot_wilcoxListFilter_REF.R"))
outfig = paste0(workdir,"FIGURES/BOXPLOT/BOXPLOT_POL2/")
pol2_ctrl_N_RPGC = readRDS(paste0(workdir, "DATA/QUANTIF/pol2_ctrl_N_RPGC_readsCounts_GB_SCALED.RDS"))
pol2_nelf_N_RPGC = readRDS(paste0(workdir, "DATA/QUANTIF/pol2_nelf_N_RPGC_readsCounts_GB_SCALED.RDS"))
PAUSE_INDICE_VEC = readRDS(paste0(workdir, "DATA/LIST_FEATURES/PAUSE_INDICE_VEC.RDS"))
PAUSE_IND_pol2_start_TSS_WT_KD = PAUSE_INDICE_VEC$PAUSE_IND_pol2_start_TSS_WT_KD
getNameList = function(Vec, topdown = "top", prct = 10){
Vec = Vec[order(Vec, decreasing=T)]
if(topdown %in% "top"){
GN = names(Vec[Vec > quantile(Vec, (100-prct)/100)])
}
if(topdown %in% "down"){
GN = names(Vec[Vec < quantile(Vec, (prct)/100)])
}
if(topdown %in% "mid"){
tmp1 = names(Vec[Vec < quantile(Vec, (100/2-prct/2)/100)])
tmp2 = names(Vec[Vec < quantile(Vec, (100/2-prct/2+prct)/100)])
GN = tmp2[tmp2 %ni% tmp1]
}
return(GN)
}
len = length(PAUSE_IND_pol2_start_TSS_WT_KD)
CTRL_60_65_PAUSE_IND_pol2_start_TSS_WT_KD = names(PAUSE_IND_pol2_start_TSS_WT_KD[(len*0.6) : (len*0.65)])
UP_25_PAUSE_IND_pol2_start_TSS_WT_KD = getNameList(PAUSE_IND_pol2_start_TSS_WT_KD, topdown = "top", prct = 25)
UP_5_PAUSE_IND_pol2_start_TSS_WT_KD = getNameList(PAUSE_IND_pol2_start_TSS_WT_KD, topdown = "top", prct = 5)
UP_1_PAUSE_IND_pol2_start_TSS_WT_KD = getNameList(PAUSE_IND_pol2_start_TSS_WT_KD, topdown = "top", prct = 1)
DN_25_PAUSE_IND_pol2_start_TSS_WT_KD = getNameList(PAUSE_IND_pol2_start_TSS_WT_KD, topdown = "down", prct = 25)
DN_5_PAUSE_IND_pol2_start_TSS_WT_KD = getNameList(PAUSE_IND_pol2_start_TSS_WT_KD, topdown = "down", prct = 5)
DN_1_PAUSE_IND_pol2_start_TSS_WT_KD = getNameList(PAUSE_IND_pol2_start_TSS_WT_KD, topdown = "down", prct = 1)
LIST_5_PAUSE_IND_pol2_start_TSS_WT_KD = list(
DN_5_PAUSE_IND_pol2_start_TSS_WT_KD = DN_5_PAUSE_IND_pol2_start_TSS_WT_KD,
UP_5_PAUSE_IND_pol2_start_TSS_WT_KD = UP_5_PAUSE_IND_pol2_start_TSS_WT_KD
)
LIST_25_UP_DN_PAUSE_IND_pol2_start_TSS_WT_KD = list(
DN_25_PAUSE_IND_pol2_start_TSS_WT_KD = DN_25_PAUSE_IND_pol2_start_TSS_WT_KD,
UP_25_PAUSE_IND_pol2_start_TSS_WT_KD = UP_25_PAUSE_IND_pol2_start_TSS_WT_KD
)
LIST_1_UP_DN_PAUSE_IND_pol2_start_TSS_WT_KD = list(
DN_1_PAUSE_IND_pol2_start_TSS_WT_KD = DN_1_PAUSE_IND_pol2_start_TSS_WT_KD,
UP_1_PAUSE_IND_pol2_start_TSS_WT_KD = UP1_ZSCORE_H3K36me3_2C4_vs_2N4
)
LIST_5_UP_CTRL_PAUSE_IND_pol2_start_TSS_WT_KD = list(
DN_5_PAUSE_IND_pol2_start_TSS_WT_KD = DN_5_PAUSE_IND_pol2_start_TSS_WT_KD,
CTRL_60_65_PAUSE_IND_pol2_start_TSS_WT_KD = CTRL_60_65_PAUSE_IND_pol2_start_TSS_WT_KD,
UP_5_PAUSE_IND_pol2_start_TSS_WT_KD = UP_5_PAUSE_IND_pol2_start_TSS_WT_KD
)
Boxplot_wilcoxListFilter_REF(quantifWT = pol2_ctrl_N_RPGC, quantifKD = pol2_nelf_N_RPGC, cond1 = "pol2_ctrl_N_RPGC", cond2="pol2_nelf_N_RPGC", filterGNList = LIST_5_PAUSE_IND_pol2_start_TSS_WT_KD,
effMin =500,  SampleNorm = c(F, "NULL"),YLIM =NULL, bxplt_color = c("#285bad", "#eb3434"), outlierTH = 0.01, logTrans=T,
outdir = outfig, readQuantif = "pol2_ctrl_N_RPGC", Cond = "pol2_nelf_N_RPGC", select = "LIST_5_PAUSE_IND_pol2_start_TSS_WT_KD", info = NULL)
Boxplot_wilcoxListFilter_REF(quantifWT = pol2_ctrl_N_RPGC, quantifKD = pol2_nelf_N_RPGC, cond1 = "pol2_ctrl_N_RPGC", cond2="pol2_nelf_N_RPGC", filterGNList = LIST_25_UP_DN_PAUSE_IND_pol2_start_TSS_WT_KD,
effMin =500,  SampleNorm = c(F, "NULL"),YLIM =NULL, bxplt_color = c("#285bad", "#eb3434"), outlierTH = 0.01, logTrans=T,
outdir = outfig, readQuantif = "pol2_ctrl_N_RPGC", Cond = "pol2_nelf_N_RPGC", select = "LIST_25_UP_DN_PAUSE_IND_pol2_start_TSS_WT_KD", info = NULL)
Boxplot_wilcoxListFilter_REF(quantifWT = pol2_ctrl_N_RPGC, quantifKD = pol2_nelf_N_RPGC, cond1 = "pol2_ctrl_N_RPGC", cond2="pol2_nelf_N_RPGC", filterGNList = LIST_1_UP_DN_PAUSE_IND_pol2_start_TSS_WT_KD,
effMin =500,  SampleNorm = c(F, "NULL"),YLIM =NULL, bxplt_color = c("#285bad", "#eb3434"), outlierTH = 0.01, logTrans=T,
outdir = outfig, readQuantif = "pol2_ctrl_N_RPGC", Cond = "pol2_nelf_N_RPGC", select = "LIST_1_UP_DN_PAUSE_IND_pol2_start_TSS_WT_KD", info = NULL)
Boxplot_wilcoxListFilter_REF(quantifWT = pol2_ctrl_N_RPGC, quantifKD = pol2_nelf_N_RPGC, cond1 = "pol2_ctrl_N_RPGC", cond2="pol2_nelf_N_RPGC", filterGNList = LIST_5_UP_CTRL_PAUSE_IND_pol2_start_TSS_WT_KD,
effMin =500,  SampleNorm = c(F, "NULL"),YLIM =NULL, bxplt_color = c("#285bad", "#eb3434"), outlierTH = 0.01, logTrans=T,
outdir = outfig, readQuantif = "pol2_ctrl_N_RPGC", Cond = "pol2_nelf_N_RPGC", select = "LIST_5_UP_CTRL_PAUSE_IND_pol2_start_TSS_WT_KD", info = NULL)
LIST_1_UP_DN_PAUSE_IND_pol2_start_TSS_WT_KD = list(
DN_1_PAUSE_IND_pol2_start_TSS_WT_KD = DN_1_PAUSE_IND_pol2_start_TSS_WT_KD,
UP_1_PAUSE_IND_pol2_start_TSS_WT_KD = UP1_ZSCORE_H3K36me3_2C4_vs_2N4
)
LIST_1_UP_DN_PAUSE_IND_pol2_start_TSS_WT_KD = list(
DN_1_PAUSE_IND_pol2_start_TSS_WT_KD = DN_1_PAUSE_IND_pol2_start_TSS_WT_KD,
UP_1_PAUSE_IND_pol2_start_TSS_WT_KD = UP_1_PAUSE_IND_pol2_start_TSS_WT_KD
)
Boxplot_wilcoxListFilter_REF(quantifWT = pol2_ctrl_N_RPGC, quantifKD = pol2_nelf_N_RPGC, cond1 = "pol2_ctrl_N_RPGC", cond2="pol2_nelf_N_RPGC", filterGNList = LIST_1_UP_DN_PAUSE_IND_pol2_start_TSS_WT_KD,
effMin =500,  SampleNorm = c(F, "NULL"),YLIM =NULL, bxplt_color = c("#285bad", "#eb3434"), outlierTH = 0.01, logTrans=T,
outdir = outfig, readQuantif = "pol2_ctrl_N_RPGC", Cond = "pol2_nelf_N_RPGC", select = "LIST_1_UP_DN_PAUSE_IND_pol2_start_TSS_WT_KD", info = NULL)
### LIBRARY
library("IRanges")
library("GenomeInfoDb")
library("GenomicRanges")
library("S4Vectors")
library("stats4")
library("BiocGenerics")
library("parallel")
######################################################################################################################################################
### LOAD DATA
######################################################################################################################################################
filename = "SEA4_Rad51_L1_RPGC"
ref_gene_gr = readRDS("~/Bureau/tdefreitas_genobioinfo/PROJET_H2AV_2025/DATA/r6.13/TxDb.Dmelanogaster.Ensembl.dm6.RDS")
file_outmatrix = as.matrix(read.table(paste0("~/Bureau/tdefreitas_genobioinfo/PROJET_H2AV_2025/DATA/PROFILE_MATRIX/", filename,".outmatrix"), skip=3))
out_profmat_RDS = paste0("~/Bureau/tdefreitas_genobioinfo/PROJET_H2AV_2025/DATA/PROFILE_MATRIX/", filename,"_profmat.RDS")
### ADD GENES ID to as rownames
rownames(file_outmatrix) = paste0(names(ref_gene_gr),".1")
saveRDS(file_outmatrix, out_profmat_RDS)
######################################################################################################################################################
### LOAD DATA
######################################################################################################################################################
filename = "SEA4_Rad51_L2_RPGC"
ref_gene_gr = readRDS("~/Bureau/tdefreitas_genobioinfo/PROJET_H2AV_2025/DATA/r6.13/TxDb.Dmelanogaster.Ensembl.dm6.RDS")
file_outmatrix = as.matrix(read.table(paste0("~/Bureau/tdefreitas_genobioinfo/PROJET_H2AV_2025/DATA/PROFILE_MATRIX/", filename,".outmatrix"), skip=3))
out_profmat_RDS = paste0("~/Bureau/tdefreitas_genobioinfo/PROJET_H2AV_2025/DATA/PROFILE_MATRIX/", filename,"_profmat.RDS")
### ADD GENES ID to as rownames
rownames(file_outmatrix) = paste0(names(ref_gene_gr),".1")
saveRDS(file_outmatrix, out_profmat_RDS)
######################################################################################################################################################
### LOAD DATA
######################################################################################################################################################
filename = "SEA4_Rad51_N1_RPGC"
ref_gene_gr = readRDS("~/Bureau/tdefreitas_genobioinfo/PROJET_H2AV_2025/DATA/r6.13/TxDb.Dmelanogaster.Ensembl.dm6.RDS")
file_outmatrix = as.matrix(read.table(paste0("~/Bureau/tdefreitas_genobioinfo/PROJET_H2AV_2025/DATA/PROFILE_MATRIX/", filename,".outmatrix"), skip=3))
out_profmat_RDS = paste0("~/Bureau/tdefreitas_genobioinfo/PROJET_H2AV_2025/DATA/PROFILE_MATRIX/", filename,"_profmat.RDS")
### ADD GENES ID to as rownames
rownames(file_outmatrix) = paste0(names(ref_gene_gr),".1")
saveRDS(file_outmatrix, out_profmat_RDS)
######################################################################################################################################################
### LOAD DATA
######################################################################################################################################################
filename = "SEA4_Rad51_N2_RPGC"
ref_gene_gr = readRDS("~/Bureau/tdefreitas_genobioinfo/PROJET_H2AV_2025/DATA/r6.13/TxDb.Dmelanogaster.Ensembl.dm6.RDS")
file_outmatrix = as.matrix(read.table(paste0("~/Bureau/tdefreitas_genobioinfo/PROJET_H2AV_2025/DATA/PROFILE_MATRIX/", filename,".outmatrix"), skip=3))
out_profmat_RDS = paste0("~/Bureau/tdefreitas_genobioinfo/PROJET_H2AV_2025/DATA/PROFILE_MATRIX/", filename,"_profmat.RDS")
### ADD GENES ID to as rownames
rownames(file_outmatrix) = paste0(names(ref_gene_gr),".1")
saveRDS(file_outmatrix, out_profmat_RDS)
######################################################################################################################################################
### LOAD DATA
######################################################################################################################################################
filename = "WT3_Rad51_L1_RPGC"
ref_gene_gr = readRDS("~/Bureau/tdefreitas_genobioinfo/PROJET_H2AV_2025/DATA/r6.13/TxDb.Dmelanogaster.Ensembl.dm6.RDS")
file_outmatrix = as.matrix(read.table(paste0("~/Bureau/tdefreitas_genobioinfo/PROJET_H2AV_2025/DATA/PROFILE_MATRIX/", filename,".outmatrix"), skip=3))
out_profmat_RDS = paste0("~/Bureau/tdefreitas_genobioinfo/PROJET_H2AV_2025/DATA/PROFILE_MATRIX/", filename,"_profmat.RDS")
### ADD GENES ID to as rownames
rownames(file_outmatrix) = paste0(names(ref_gene_gr),".1")
saveRDS(file_outmatrix, out_profmat_RDS)
######################################################################################################################################################
### LOAD DATA
######################################################################################################################################################
filename = "WT3_Rad51_L2_RPGC"
ref_gene_gr = readRDS("~/Bureau/tdefreitas_genobioinfo/PROJET_H2AV_2025/DATA/r6.13/TxDb.Dmelanogaster.Ensembl.dm6.RDS")
file_outmatrix = as.matrix(read.table(paste0("~/Bureau/tdefreitas_genobioinfo/PROJET_H2AV_2025/DATA/PROFILE_MATRIX/", filename,".outmatrix"), skip=3))
out_profmat_RDS = paste0("~/Bureau/tdefreitas_genobioinfo/PROJET_H2AV_2025/DATA/PROFILE_MATRIX/", filename,"_profmat.RDS")
### ADD GENES ID to as rownames
rownames(file_outmatrix) = paste0(names(ref_gene_gr),".1")
saveRDS(file_outmatrix, out_profmat_RDS)
######################################################################################################################################################
### LOAD DATA
######################################################################################################################################################
filename = "WT3_Rad51_N1_RPGC"
ref_gene_gr = readRDS("~/Bureau/tdefreitas_genobioinfo/PROJET_H2AV_2025/DATA/r6.13/TxDb.Dmelanogaster.Ensembl.dm6.RDS")
file_outmatrix = as.matrix(read.table(paste0("~/Bureau/tdefreitas_genobioinfo/PROJET_H2AV_2025/DATA/PROFILE_MATRIX/", filename,".outmatrix"), skip=3))
out_profmat_RDS = paste0("~/Bureau/tdefreitas_genobioinfo/PROJET_H2AV_2025/DATA/PROFILE_MATRIX/", filename,"_profmat.RDS")
### ADD GENES ID to as rownames
rownames(file_outmatrix) = paste0(names(ref_gene_gr),".1")
saveRDS(file_outmatrix, out_profmat_RDS)
######################################################################################################################################################
### LOAD DATA
######################################################################################################################################################
filename = "WT3_Rad51_N2_RPGC"
ref_gene_gr = readRDS("~/Bureau/tdefreitas_genobioinfo/PROJET_H2AV_2025/DATA/r6.13/TxDb.Dmelanogaster.Ensembl.dm6.RDS")
file_outmatrix = as.matrix(read.table(paste0("~/Bureau/tdefreitas_genobioinfo/PROJET_H2AV_2025/DATA/PROFILE_MATRIX/", filename,".outmatrix"), skip=3))
out_profmat_RDS = paste0("~/Bureau/tdefreitas_genobioinfo/PROJET_H2AV_2025/DATA/PROFILE_MATRIX/", filename,"_profmat.RDS")
### ADD GENES ID to as rownames
rownames(file_outmatrix) = paste0(names(ref_gene_gr),".1")
saveRDS(file_outmatrix, out_profmat_RDS)
######################################################
# Load LIBRARY
library(gplots)
'%ni%' = Negate('%in%')
require(GenomicRanges)
require(BiocGenerics)
require(parallel)
workdir = "~/Bureau/tdefreitas_genobioinfo/PROJET_H2AV_2025/DATA/"
profdir = paste0(workdir, "PROFILE_MATRIX/")
outdir = paste0(workdir, "QUANTIF/")
readSumWindow = function(prof, start=400, end=800){
Nameprof = deparse(substitute(prof))
print(Nameprof)
prof = rowSums(prof[,c(start:end)])
filenameRDS = paste0(outdir, "Q_", Nameprof ,  "_readsCounts_GB_SCALED.RDS")
saveRDS(prof, file=filenameRDS)
}
SEA4_Rad51_L1_RPGC_profmat = readRDS(paste0(profdir, "SEA4_Rad51_L1_RPGC_profmat.RDS"))
readSumWindow(SEA4_Rad51_L1_RPGC_profmat)
rm(SEA4_Rad51_L1_RPGC_profmat)
SEA4_Rad51_L2_RPGC_profmat = readRDS(paste0(profdir, "SEA4_Rad51_L2_RPGC_profmat.RDS"))
readSumWindow(SEA4_Rad51_L2_RPGC_profmat)
rm(SEA4_Rad51_L1_RPGC_profmat)
rm(SEA4_Rad51_L2_RPGC_profmat)
SEA4_Rad51_N1_RPGC_profmat = readRDS(paste0(profdir, "SEA4_Rad51_N1_RPGC_profmat.RDS"))
readSumWindow(SEA4_Rad51_N1_RPGC_profmat)
rm(SEA4_Rad51_N1_RPGC_profmat)
SEA4_Rad51_N2_RPGC_profmat = readRDS(paste0(profdir, "SEA4_Rad51_N2_RPGC_profmat.RDS"))
readSumWindow(SEA4_Rad51_N2_RPGC_profmat)
rm(SEA4_Rad51_N2_RPGC_profmat)
WT3_Rad51_L1_RPGC_profmat = readRDS(paste0(profdir, "WT3_Rad51_L1_RPGC_profmat.RDS"))
readSumWindow(WT3_Rad51_L1_RPGC_profmat)
rm(WT3_Rad51_L1_RPGC_profmat)
WT3_Rad51_L2_RPGC_profmat = readRDS(paste0(profdir, "WT3_Rad51_L2_RPGC_profmat.RDS"))
readSumWindow(WT3_Rad51_L2_RPGC_profmat)
rm(WT3_Rad51_L2_RPGC_profmat)
WT3_Rad51_N1_RPGC_profmat = readRDS(paste0(profdir, "WT3_Rad51_N1_RPGC_profmat.RDS"))
readSumWindow(WT3_Rad51_N1_RPGC_profmat)
rm(WT3_Rad51_N1_RPGC_profmat)
WT3_Rad51_N2_RPGC_profmat = readRDS(paste0(profdir, "WT3_Rad51_N2_RPGC_profmat.RDS"))
readSumWindow(WT3_Rad51_N2_RPGC_profmat)
rm(WT3_Rad51_N2_RPGC_profmat)
library(ggpubr)
library(rstatix)
library("gplots")
library(textplot)
library("ggplot2")
library(dplyr)
'%ni%' = Negate('%in%')
workdir = "~/Bureau/tdefreitas_genobioinfo/PROJET_H2AV_2025/"
source(paste0(workdir,"functionR/Boxplot_wilcoxListFilter_REF.R"))
outfig = paste0(workdir,"FIGURES/BOXPLOT/BOXPLOT_Q_H2AV_SEA4_WT3/BY_ZSCORE_H3K36me3_2C4_H3K36me3_2N4_f/")
outfig2 = paste0(workdir,"FIGURES/BOXPLOT/BOXPLOT_Q_H2AV_SEA4_WT3/BY_Q_H3K36me3_2C4_GB_f/")
Q_GB_SEA4_NELFKD_R3_f = readRDS(paste0(workdir,"DATA/QUANTIF/Q_GB_SEA4_NELFKD_R3_f.RDS"))
Q_GB_SEA4_WT_R3_f = readRDS(paste0(workdir,"DATA/QUANTIF/Q_GB_SEA4_WT_R3_f.RDS"))
Q_GB_WT3_NELFKD_R3_f = readRDS(paste0(workdir,"DATA/QUANTIF/Q_GB_WT3_NELFKD_R3_f.RDS"))
Q_GB_WT3_WT_R3_f = readRDS(paste0(workdir,"DATA/QUANTIF/Q_GB_WT3_WT_R3_f.RDS"))
Q_H2AV_SEA4_LucKD=readRDS(paste0(workdir,"DATA/QUANTIF/Q_H2AV-R2_SEA4_Luc-KD_RPKM_upstr500_dnstr500.RDS"))
Q_H2AV_SEA4_NelfKD=readRDS(paste0(workdir,"DATA/QUANTIF/Q_H2AV-R2_SEA4_Nelf-KD_RPKM_upstr500_dnstr500.RDS"))
Q_H2AV_WT3_LucKD=readRDS(paste0(workdir,"DATA/QUANTIF/Q_H2AV-R2_WT3_Luc-KD_RPKM_upstr500_dnstr500.RDS"))
Q_H2AV_WT3_NelfKD=readRDS(paste0(workdir,"DATA/QUANTIF/Q_H2AV-R2_WT3_Nelf-KD_RPKM_upstr500_dnstr500.RDS"))
names(Q_H2AV_SEA4_LucKD) <- paste0(names(Q_H2AV_SEA4_LucKD), ".1")
names(Q_H2AV_SEA4_NelfKD) <- paste0(names(Q_H2AV_SEA4_NelfKD), ".1")
names(Q_H2AV_WT3_LucKD) <- paste0(names(Q_H2AV_WT3_LucKD), ".1")
names(Q_H2AV_WT3_NelfKD) <- paste0(names(Q_H2AV_WT3_NelfKD), ".1")
LIST_QUANTIF_K36=readRDS(paste0(workdir,"DATA/LIST_FEATURES/LIST_QUANTIF_K36.RDS"))
Q_H3K36me3_2C4_GB_f=LIST_QUANTIF_K36$Q_H3K36me3_2C4_GB_f
ZSCORE_H3K36me3_2C4_H3K36me3_2N4_f = LIST_QUANTIF_K36$ZSCORE_H3K36me3_2C4_H3K36me3_2N4_f
getNameList = function(Vec, topdown = "top", prct = 10){
Vec = Vec[order(Vec, decreasing=T)]
if(topdown %in% "top"){
GN = names(Vec[Vec > quantile(Vec, (100-prct)/100)])
}
if(topdown %in% "down"){
GN = names(Vec[Vec < quantile(Vec, (prct)/100)])
}
if(topdown %in% "mid"){
tmp1 = names(Vec[Vec < quantile(Vec, (100/2-prct/2)/100)])
tmp2 = names(Vec[Vec < quantile(Vec, (100/2-prct/2+prct)/100)])
GN = tmp2[tmp2 %ni% tmp1]
}
return(GN)
}
len = length(ZSCORE_H3K36me3_2C4_H3K36me3_2N4_f)
CTRL5_ZSCORE_H3K36me3_2C4_vs_2N4 = names(ZSCORE_H3K36me3_2C4_H3K36me3_2N4_f[(len*0.6) : (len*0.65)])
DN5_ZSCORE_H3K36me3_2C4_vs_2N4 = getNameList(ZSCORE_H3K36me3_2C4_H3K36me3_2N4_f, topdown = "down", prct = 5)
UP5_ZSCORE_H3K36me3_2C4_vs_2N4 = getNameList(ZSCORE_H3K36me3_2C4_H3K36me3_2N4_f, topdown = "top", prct = 5)
DN1_ZSCORE_H3K36me3_2C4_vs_2N4 = getNameList(ZSCORE_H3K36me3_2C4_H3K36me3_2N4_f, topdown = "down", prct = 1)
UP1_ZSCORE_H3K36me3_2C4_vs_2N4 = getNameList(ZSCORE_H3K36me3_2C4_H3K36me3_2N4_f, topdown = "top", prct = 1)
len = length(Q_H3K36me3_2C4_GB_f)
CTRL5_Q_H3K36me3_2C4 = names(Q_H3K36me3_2C4_GB_f[(len*0.6) : (len*0.65)])
UP5_Q_H3K36me3_2C4 = getNameList(Q_H3K36me3_2C4_GB_f, topdown = "top", prct = 5)
DN5_Q_H3K36me3_2C4 = getNameList(Q_H3K36me3_2C4_GB_f, topdown = "down", prct = 5)
UP1_Q_H3K36me3_2C4 = getNameList(Q_H3K36me3_2C4_GB_f, topdown = "top", prct = 1)
DN1_Q_H3K36me3_2C4 = getNameList(Q_H3K36me3_2C4_GB_f, topdown = "down", prct = 1)
LIST_5_UP_DN_ZSCORE_H3K36me3_2C4_vs_2N4=list(
DN5_ZSCORE_H3K36me3_2C4_vs_2N4=DN5_ZSCORE_H3K36me3_2C4_vs_2N4,
delta_UP5_ZSCORE_H3K36me3_2C4_vs_2N4=UP5_ZSCORE_H3K36me3_2C4_vs_2N4
)
LIST_1_UP_DN_ZSCORE_H3K36me3_2C4_vs_2N4=list(
DN1_ZSCORE_H3K36me3_2C4_vs_2N4=DN1_ZSCORE_H3K36me3_2C4_vs_2N4,
delta_UP1_ZSCORE_H3K36me3_2C4_vs_2N4=UP1_ZSCORE_H3K36me3_2C4_vs_2N4
)
LIST_5_UP_CTRL_ZSCORE_H3K36me3_2C4_vs_2N4=list(
DN5_H3K36me3_2C4_vs_2N4=DN5_ZSCORE_H3K36me3_2C4_vs_2N4,
CTRL_60_65_H3K36me3_2C4_vs_2N4 = CTRL5_ZSCORE_H3K36me3_2C4_vs_2N4,
delta_UP5_H3K36me3_2C4_vs_2N4 = UP5_ZSCORE_H3K36me3_2C4_vs_2N4
)
LIST_5_UP_DN_Q_H3K36me3_2C4_GB_f = list(
DN5_DN5_Q_H3K36me3_2C4 = DN5_Q_H3K36me3_2C4,
delta_UP5_Q_H3K36me3_2C4 = UP5_Q_H3K36me3_2C4
)
LIST_1_UP_DN_Q_H3K36me3_2C4_GB_f = list(
DN1_Q_H3K36me3_2C4 = DN1_Q_H3K36me3_2C4,
delta_UP1_Q_H3K36me3_2C4 = UP1_Q_H3K36me3_2C4
)
LIST_5_UP_CTRL_Q_H3K36me3_2C4_GB_f = list(
DN5_Q_H3K36me3_2C4 = DN5_Q_H3K36me3_2C4,
CTRL60_65_Q_H3K36me3_2C4 = CTRL5_Q_H3K36me3_2C4,
delta_UP5_Q_H3K36me3_2C4 = UP5_Q_H3K36me3_2C4
)
Boxplot_wilcoxListFilter_REF(quantifWT = Q_H2AV_SEA4_LucKD, quantifKD = Q_H2AV_SEA4_NelfKD, cond1 = "Q_H2AV_SEA4_LucKD", cond2="Q_H2AV_SEA4_NelfKD", filterGNList = LIST_5_UP_DN_ZSCORE_H3K36me3_2C4_vs_2N4,
effMin =500,  SampleNorm = c(F, "NULL"),YLIM =NULL, bxplt_color = c("#285bad", "#eb3434"), outlierTH = 0.01, logTrans=T,
outdir = outfig, readQuantif = "Q_H2AV_SEA4_LucKD", Cond = "Q_H2AV_SEA4_NelfKD", select = "LIST_5_UP_DN_ZSCORE_H3K36me3_2C4_vs_2N4", info = NULL)
Boxplot_wilcoxListFilter_REF(quantifWT = Q_H2AV_WT3_LucKD, quantifKD = Q_H2AV_WT3_NelfKD, cond1 = "Q_H2AV_WT3_LucKD", cond2="Q_H2AV_WT3_NelfKD", filterGNList = LIST_5_UP_DN_ZSCORE_H3K36me3_2C4_vs_2N4,
effMin =500,  SampleNorm = c(F, "NULL"),YLIM =NULL, bxplt_color = c("#285bad", "#eb3434"), outlierTH = 0.01, logTrans=T,
outdir = outfig, readQuantif = "Q_H2AV_WT3_LucKD", Cond = "Q_H2AV_WT3_NelfKD", select = "LIST_5_UP_DN_ZSCORE_H3K36me3_2C4_vs_2N4", info = NULL)
Boxplot_wilcoxListFilter_REF(quantifWT = Q_H2AV_SEA4_LucKD, quantifKD = Q_H2AV_SEA4_NelfKD, cond1 = "Q_H2AV_SEA4_LucKD", cond2="Q_H2AV_SEA4_NelfKD", filterGNList = LIST_1_UP_DN_ZSCORE_H3K36me3_2C4_vs_2N4,
effMin =500,  SampleNorm = c(F, "NULL"),YLIM =NULL, bxplt_color = c("#285bad", "#eb3434"), outlierTH = 0.01, logTrans=T,
outdir = outfig, readQuantif = "Q_H2AV_SEA4_LucKD", Cond = "Q_H2AV_SEA4_NelfKD", select = "LIST_1_UP_DN_ZSCORE_H3K36me3_2C4_vs_2N4", info = NULL)
Boxplot_wilcoxListFilter_REF(quantifWT = Q_H2AV_WT3_LucKD, quantifKD = Q_H2AV_WT3_NelfKD, cond1 = "Q_H2AV_WT3_LucKD", cond2="Q_H2AV_WT3_NelfKD", filterGNList = LIST_1_UP_DN_ZSCORE_H3K36me3_2C4_vs_2N4,
effMin =500,  SampleNorm = c(F, "NULL"),YLIM =NULL, bxplt_color = c("#285bad", "#eb3434"), outlierTH = 0.01, logTrans=T,
outdir = outfig, readQuantif = "Q_H2AV_WT3_LucKD", Cond = "Q_H2AV_WT3_NelfKD", select = "LIST_1_UP_DN_ZSCORE_H3K36me3_2C4_vs_2N4", info = NULL)
Boxplot_wilcoxListFilter_REF(quantifWT = Q_H2AV_SEA4_LucKD, quantifKD = Q_H2AV_SEA4_NelfKD, cond1 = "Q_H2AV_SEA4_LucKD", cond2="Q_H2AV_SEA4_NelfKD", filterGNList = LIST_5_UP_CTRL_ZSCORE_H3K36me3_2C4_vs_2N4,
effMin =500,  SampleNorm = c(F, "NULL"),YLIM =NULL, bxplt_color = c("#285bad", "#eb3434"), outlierTH = 0.01, logTrans=T,
outdir = outfig, readQuantif = "Q_H2AV_SEA4_LucKD", Cond = "Q_H2AV_SEA4_NelfKD", select = "LIST_5_UP_CTRL_ZSCORE_H3K36me3_2C4_vs_2N4", info = NULL)
Boxplot_wilcoxListFilter_REF(quantifWT = Q_H2AV_WT3_LucKD, quantifKD = Q_H2AV_WT3_NelfKD, cond1 = "Q_H2AV_WT3_LucKD", cond2="Q_H2AV_WT3_NelfKD", filterGNList = LIST_5_UP_CTRL_ZSCORE_H3K36me3_2C4_vs_2N4,
effMin =500,  SampleNorm = c(F, "NULL"),YLIM =NULL, bxplt_color = c("#285bad", "#eb3434"), outlierTH = 0.01, logTrans=T,
outdir = outfig, readQuantif = "Q_H2AV_WT3_LucKD", Cond = "Q_H2AV_WT3_NelfKD", select = "LIST_5_UP_CTRL_ZSCORE_H3K36me3_2C4_vs_2N4", info = NULL)
Boxplot_wilcoxListFilter_REF(quantifWT = Q_GB_SEA4_WT_R3_f, quantifKD = Q_GB_SEA4_NELFKD_R3_f, cond1 = "Q_GB_SEA4_WT_R3_f", cond2="Q_GB_SEA4_NELFKD_R3_f", filterGNList = LIST_5_UP_DN_ZSCORE_H3K36me3_2C4_vs_2N4,
effMin =500,  SampleNorm = c(F, "NULL"),YLIM =NULL, bxplt_color = c("#285bad", "#eb3434"), outlierTH = 0.01, logTrans=T,
outdir = outfig, readQuantif = "Q_GB_SEA4_WT_R3_f", Cond = "Q_GB_SEA4_NELFKD_R3_f", select = "LIST_5_UP_DN_ZSCORE_H3K36me3_2C4_vs_2N4", info = NULL)
Boxplot_wilcoxListFilter_REF(quantifWT = Q_GB_WT3_WT_R3_f, quantifKD = Q_GB_WT3_NELFKD_R3_f, cond1 = "Q_GB_WT3_WT_R3_f", cond2="Q_GB_WT3_NELFKD_R3_f", filterGNList = LIST_5_UP_DN_ZSCORE_H3K36me3_2C4_vs_2N4,
effMin =500,  SampleNorm = c(F, "NULL"),YLIM =NULL, bxplt_color = c("#285bad", "#eb3434"), outlierTH = 0.01, logTrans=T,
outdir = outfig, readQuantif = "Q_GB_WT3_WT_R3_f", Cond = "Q_GB_WT3_NELFKD_R3_f", select = "LIST_5_UP_DN_ZSCORE_H3K36me3_2C4_vs_2N4", info = NULL)
Boxplot_wilcoxListFilter_REF(quantifWT = Q_GB_SEA4_WT_R3_f, quantifKD = Q_GB_SEA4_NELFKD_R3_f, cond1 = "Q_GB_SEA4_WT_R3_f", cond2="Q_GB_SEA4_NELFKD_R3_f", filterGNList = LIST_1_UP_DN_ZSCORE_H3K36me3_2C4_vs_2N4,
effMin =500,  SampleNorm = c(F, "NULL"),YLIM =NULL, bxplt_color = c("#285bad", "#eb3434"), outlierTH = 0.01, logTrans=T,
outdir = outfig, readQuantif = "Q_GB_SEA4_WT_R3_f", Cond = "Q_GB_SEA4_NELFKD_R3_f", select = "LIST_1_UP_DN_ZSCORE_H3K36me3_2C4_vs_2N4", info = NULL)
Boxplot_wilcoxListFilter_REF(quantifWT = Q_GB_WT3_WT_R3_f, quantifKD = Q_GB_WT3_NELFKD_R3_f, cond1 = "Q_GB_WT3_WT_R3_f", cond2="Q_GB_WT3_NELFKD_R3_f", filterGNList = LIST_1_UP_DN_ZSCORE_H3K36me3_2C4_vs_2N4,
effMin =500,  SampleNorm = c(F, "NULL"),YLIM =NULL, bxplt_color = c("#285bad", "#eb3434"), outlierTH = 0.01, logTrans=T,
outdir = outfig, readQuantif = "Q_GB_WT3_WT_R3_f", Cond = "Q_GB_WT3_NELFKD_R3_f", select = "LIST_1_UP_DN_ZSCORE_H3K36me3_2C4_vs_2N4", info = NULL)
Boxplot_wilcoxListFilter_REF(quantifWT = Q_GB_SEA4_WT_R3_f, quantifKD = Q_GB_SEA4_NELFKD_R3_f, cond1 = "Q_GB_SEA4_WT_R3_f", cond2="Q_GB_SEA4_NELFKD_R3_f", filterGNList = LIST_5_UP_CTRL_ZSCORE_H3K36me3_2C4_vs_2N4,
effMin =500,  SampleNorm = c(F, "NULL"),YLIM =NULL, bxplt_color = c("#285bad", "#eb3434"), outlierTH = 0.01, logTrans=T,
outdir = outfig, readQuantif = "Q_GB_SEA4_WT_R3_f", Cond = "Q_GB_SEA4_NELFKD_R3_f", select = "LIST_5_UP_CTRL_ZSCORE_H3K36me3_2C4_vs_2N4", info = NULL)
Boxplot_wilcoxListFilter_REF(quantifWT = Q_GB_WT3_WT_R3_f, quantifKD = Q_GB_WT3_NELFKD_R3_f, cond1 = "Q_GB_WT3_WT_R3_f", cond2="Q_GB_WT3_NELFKD_R3_f", filterGNList = LIST_5_UP_CTRL_ZSCORE_H3K36me3_2C4_vs_2N4,
effMin =500,  SampleNorm = c(F, "NULL"),YLIM =NULL, bxplt_color = c("#285bad", "#eb3434"), outlierTH = 0.01, logTrans=T,
outdir = outfig, readQuantif = "Q_GB_WT3_WT_R3_f", Cond = "Q_GB_WT3_NELFKD_R3_f", select = "LIST_5_UP_CTRL_ZSCORE_H3K36me3_2C4_vs_2N4", info = NULL)
Boxplot_wilcoxListFilter_REF(quantifWT = Q_H2AV_SEA4_LucKD, quantifKD = Q_H2AV_SEA4_NelfKD, cond1 = "Q_H2AV_SEA4_LucKD", cond2="Q_H2AV_SEA4_NelfKD", filterGNList = LIST_5_UP_DN_Q_H3K36me3_2C4_GB_f,
effMin =500,  SampleNorm = c(F, "NULL"),YLIM =NULL, bxplt_color = c("#285bad", "#eb3434"), outlierTH = 0.01, logTrans=T,
outdir = outfig2, readQuantif = "Q_H2AV_SEA4_LucKD", Cond = "Q_H2AV_SEA4_NelfKD", select = "LIST_5_UP_DN_Q_H3K36me3_2C4_GB_f", info = NULL)
Boxplot_wilcoxListFilter_REF(quantifWT = Q_H2AV_WT3_LucKD, quantifKD = Q_H2AV_WT3_NelfKD, cond1 = "Q_H2AV_WT3_LucKD", cond2="Q_H2AV_WT3_NelfKD", filterGNList = LIST_5_UP_DN_Q_H3K36me3_2C4_GB_f,
effMin =500,  SampleNorm = c(F, "NULL"),YLIM =NULL, bxplt_color = c("#285bad", "#eb3434"), outlierTH = 0.01, logTrans=T,
outdir = outfig2, readQuantif = "Q_H2AV_WT3_LucKD", Cond = "Q_H2AV_WT3_NelfKD", select = "LIST_5_UP_DN_Q_H3K36me3_2C4_GB_f", info = NULL)
Boxplot_wilcoxListFilter_REF(quantifWT = Q_H2AV_SEA4_LucKD, quantifKD = Q_H2AV_SEA4_NelfKD, cond1 = "Q_H2AV_SEA4_LucKD", cond2="Q_H2AV_SEA4_NelfKD", filterGNList = LIST_1_UP_DN_Q_H3K36me3_2C4_GB_f,
effMin =500,  SampleNorm = c(F, "NULL"),YLIM =NULL, bxplt_color = c("#285bad", "#eb3434"), outlierTH = 0.01, logTrans=T,
outdir = outfig2, readQuantif = "Q_H2AV_SEA4_LucKD", Cond = "Q_H2AV_SEA4_NelfKD", select = "LIST_1_UP_DN_Q_H3K36me3_2C4_GB_f", info = NULL)
Boxplot_wilcoxListFilter_REF(quantifWT = Q_H2AV_WT3_LucKD, quantifKD = Q_H2AV_WT3_NelfKD, cond1 = "Q_H2AV_WT3_LucKD", cond2="Q_H2AV_WT3_NelfKD", filterGNList = LIST_1_UP_DN_Q_H3K36me3_2C4_GB_f,
effMin =500,  SampleNorm = c(F, "NULL"),YLIM =NULL, bxplt_color = c("#285bad", "#eb3434"), outlierTH = 0.01, logTrans=T,
outdir = outfig2, readQuantif = "Q_H2AV_WT3_LucKD", Cond = "Q_H2AV_WT3_NelfKD", select = "LIST_1_UP_DN_Q_H3K36me3_2C4_GB_f", info = NULL)
Boxplot_wilcoxListFilter_REF(quantifWT = Q_H2AV_SEA4_LucKD, quantifKD = Q_H2AV_SEA4_NelfKD, cond1 = "Q_H2AV_SEA4_LucKD", cond2="Q_H2AV_SEA4_NelfKD", filterGNList = LIST_5_UP_CTRL_Q_H3K36me3_2C4_GB_f,
effMin =500,  SampleNorm = c(F, "NULL"),YLIM =NULL, bxplt_color = c("#285bad", "#eb3434"), outlierTH = 0.01, logTrans=T,
outdir = outfig2, readQuantif = "Q_H2AV_SEA4_LucKD", Cond = "Q_H2AV_SEA4_NelfKD", select = "LIST_5_UP_CTRL_Q_H3K36me3_2C4_GB_f", info = NULL)
Boxplot_wilcoxListFilter_REF(quantifWT = Q_H2AV_WT3_LucKD, quantifKD = Q_H2AV_WT3_NelfKD, cond1 = "Q_H2AV_WT3_LucKD", cond2="Q_H2AV_WT3_NelfKD", filterGNList = LIST_5_UP_CTRL_Q_H3K36me3_2C4_GB_f,
effMin =500,  SampleNorm = c(F, "NULL"),YLIM =NULL, bxplt_color = c("#285bad", "#eb3434"), outlierTH = 0.01, logTrans=T,
outdir = outfig2, readQuantif = "Q_H2AV_WT3_LucKD", Cond = "Q_H2AV_WT3_NelfKD", select = "LIST_5_UP_CTRL_Q_H3K36me3_2C4_GB_f", info = NULL)
Boxplot_wilcoxListFilter_REF(quantifWT = Q_GB_SEA4_WT_R3_f, quantifKD = Q_GB_SEA4_NELFKD_R3_f, cond1 = "Q_GB_SEA4_WT_R3_f", cond2="Q_GB_SEA4_NELFKD_R3_f", filterGNList = LIST_5_UP_DN_Q_H3K36me3_2C4_GB_f,
effMin =500,  SampleNorm = c(F, "NULL"),YLIM =NULL, bxplt_color = c("#285bad", "#eb3434"), outlierTH = 0.01, logTrans=T,
outdir = outfig2, readQuantif = "Q_GB_SEA4_WT_R3_f", Cond = "Q_GB_SEA4_NELFKD_R3_f", select = "LIST_5_UP_DN_Q_H3K36me3_2C4_GB_f", info = NULL)
Boxplot_wilcoxListFilter_REF(quantifWT = Q_GB_WT3_WT_R3_f, quantifKD = Q_GB_WT3_NELFKD_R3_f, cond1 = "Q_GB_WT3_WT_R3_f", cond2="Q_GB_WT3_NELFKD_R3_f", filterGNList = LIST_5_UP_DN_Q_H3K36me3_2C4_GB_f,
effMin =500,  SampleNorm = c(F, "NULL"),YLIM =NULL, bxplt_color = c("#285bad", "#eb3434"), outlierTH = 0.01, logTrans=T,
outdir = outfig2, readQuantif = "Q_GB_WT3_WT_R3_f", Cond = "Q_GB_WT3_NELFKD_R3_f", select = "LIST_5_UP_DN_Q_H3K36me3_2C4_GB_f", info = NULL)
Boxplot_wilcoxListFilter_REF(quantifWT = Q_GB_SEA4_WT_R3_f, quantifKD = Q_GB_SEA4_NELFKD_R3_f, cond1 = "Q_GB_SEA4_WT_R3_f", cond2="Q_GB_SEA4_NELFKD_R3_f", filterGNList = LIST_1_UP_DN_Q_H3K36me3_2C4_GB_f,
effMin =500,  SampleNorm = c(F, "NULL"),YLIM =NULL, bxplt_color = c("#285bad", "#eb3434"), outlierTH = 0.01, logTrans=T,
outdir = outfig2, readQuantif = "Q_GB_SEA4_WT_R3_f", Cond = "Q_GB_SEA4_NELFKD_R3_f", select = "LIST_1_UP_DN_Q_H3K36me3_2C4_GB_f", info = NULL)
Boxplot_wilcoxListFilter_REF(quantifWT = Q_GB_WT3_WT_R3_f, quantifKD = Q_GB_WT3_NELFKD_R3_f, cond1 = "Q_GB_WT3_WT_R3_f", cond2="Q_GB_WT3_NELFKD_R3_f", filterGNList = LIST_1_UP_DN_Q_H3K36me3_2C4_GB_f,
effMin =500,  SampleNorm = c(F, "NULL"),YLIM =NULL, bxplt_color = c("#285bad", "#eb3434"), outlierTH = 0.01, logTrans=T,
outdir = outfig2, readQuantif = "Q_GB_WT3_WT_R3_f", Cond = "Q_GB_WT3_NELFKD_R3_f", select = "LIST_1_UP_DN_Q_H3K36me3_2C4_GB_f", info = NULL)
Boxplot_wilcoxListFilter_REF(quantifWT = Q_GB_SEA4_WT_R3_f, quantifKD = Q_GB_SEA4_NELFKD_R3_f, cond1 = "Q_GB_SEA4_WT_R3_f", cond2="Q_GB_SEA4_NELFKD_R3_f", filterGNList = LIST_5_UP_CTRL_Q_H3K36me3_2C4_GB_f,
effMin =500,  SampleNorm = c(F, "NULL"),YLIM =NULL, bxplt_color = c("#285bad", "#eb3434"), outlierTH = 0.01, logTrans=T,
outdir = outfig2, readQuantif = "Q_GB_SEA4_WT_R3_f", Cond = "Q_GB_SEA4_NELFKD_R3_f", select = "LIST_5_UP_CTRL_Q_H3K36me3_2C4_GB_f", info = NULL)
Boxplot_wilcoxListFilter_REF(quantifWT = Q_GB_WT3_WT_R3_f, quantifKD = Q_GB_WT3_NELFKD_R3_f, cond1 = "Q_GB_WT3_WT_R3_f", cond2="Q_GB_WT3_NELFKD_R3_f", filterGNList = LIST_5_UP_CTRL_Q_H3K36me3_2C4_GB_f,
effMin =500,  SampleNorm = c(F, "NULL"),YLIM =NULL, bxplt_color = c("#285bad", "#eb3434"), outlierTH = 0.01, logTrans=T,
outdir = outfig2, readQuantif = "Q_GB_WT3_WT_R3_f", Cond = "Q_GB_WT3_NELFKD_R3_f", select = "LIST_5_UP_CTRL_Q_H3K36me3_2C4_GB_f", info = NULL)
library(ggpubr)
library(rstatix)
library("gplots")
library(textplot)
library("ggplot2")
library(dplyr)
'%ni%' = Negate('%in%')
workdir = "~/Bureau/tdefreitas_genobioinfo/PROJET_H2AV_2025/"
source(paste0(workdir,"functionR/Boxplot_wilcoxListFilter_REF.R"))
outfig = paste0(workdir,"FIGURES/BOXPLOT/BOXPLOT_RAD51/")
Q_WT3_Rad51_N1 = readRDS(paste0(workdir,"DATA/QUANTIF/Q_WT3_Rad51_N1_RPGC_profmat_readsCounts_GB_SCALED.RDS"))
Q_WT3_Rad51_N2 = readRDS(paste0(workdir,"DATA/QUANTIF/Q_WT3_Rad51_N2_RPGC_profmat_readsCounts_GB_SCALED.RDS"))
Q_WT3_Rad51_L1 = readRDS(paste0(workdir,"DATA/QUANTIF/Q_WT3_Rad51_L1_RPGC_profmat_readsCounts_GB_SCALED.RDS"))
Q_WT3_Rad51_L2 = readRDS(paste0(workdir,"DATA/QUANTIF/Q_WT3_Rad51_L2_RPGC_profmat_readsCounts_GB_SCALED.RDS"))
Q_SEA4_Rad51_N1 = readRDS(paste0(workdir,"DATA/QUANTIF/Q_SEA4_Rad51_N1_RPGC_profmat_readsCounts_GB_SCALED.RDS"))
Q_SEA4_Rad51_N2 = readRDS(paste0(workdir,"DATA/QUANTIF/Q_SEA4_Rad51_N2_RPGC_profmat_readsCounts_GB_SCALED.RDS"))
Q_SEA4_Rad51_L1 = readRDS(paste0(workdir,"DATA/QUANTIF/Q_SEA4_Rad51_L1_RPGC_profmat_readsCounts_GB_SCALED.RDS"))
Q_SEA4_Rad51_L2 = readRDS(paste0(workdir,"DATA/QUANTIF/Q_SEA4_Rad51_L2_RPGC_profmat_readsCounts_GB_SCALED.RDS"))
LIST_QUANTIF_K36=readRDS(paste0(workdir,"DATA/LIST_FEATURES/LIST_QUANTIF_K36.RDS"))
Q_H3K36me3_2C4_GB_f=LIST_QUANTIF_K36$Q_H3K36me3_2C4_GB_f
ZSCORE_H3K36me3_2C4_H3K36me3_2N4_f = LIST_QUANTIF_K36$ZSCORE_H3K36me3_2C4_H3K36me3_2N4_f
getNameList = function(Vec, topdown = "top", prct = 10){
Vec = Vec[order(Vec, decreasing=T)]
if(topdown %in% "top"){
GN = names(Vec[Vec > quantile(Vec, (100-prct)/100)])
}
if(topdown %in% "down"){
GN = names(Vec[Vec < quantile(Vec, (prct)/100)])
}
if(topdown %in% "mid"){
tmp1 = names(Vec[Vec < quantile(Vec, (100/2-prct/2)/100)])
tmp2 = names(Vec[Vec < quantile(Vec, (100/2-prct/2+prct)/100)])
GN = tmp2[tmp2 %ni% tmp1]
}
return(GN)
}
len = length(Q_H3K36me3_2C4_GB_f)
CTRL5_Q_H3K36me3_2C4 = names(Q_H3K36me3_2C4_GB_f[(len*0.6) : (len*0.65)])
UP5_Q_H3K36me3_2C4 = getNameList(Q_H3K36me3_2C4_GB_f, topdown = "top", prct = 5)
DN5_Q_H3K36me3_2C4 = getNameList(Q_H3K36me3_2C4_GB_f, topdown = "down", prct = 5)
UP1_Q_H3K36me3_2C4 = getNameList(Q_H3K36me3_2C4_GB_f, topdown = "top", prct = 1)
DN1_Q_H3K36me3_2C4 = getNameList(Q_H3K36me3_2C4_GB_f, topdown = "down", prct = 1)
LIST_5_UP_DN_Q_H3K36me3_2C4_GB_f = list(
DN5_DN5_Q_H3K36me3_2C4 = DN5_Q_H3K36me3_2C4,
delta_UP5_Q_H3K36me3_2C4 = UP5_Q_H3K36me3_2C4
)
LIST_1_UP_DN_Q_H3K36me3_2C4_GB_f = list(
DN1_Q_H3K36me3_2C4 = DN1_Q_H3K36me3_2C4,
delta_UP1_Q_H3K36me3_2C4 = UP1_Q_H3K36me3_2C4
)
LIST_5_UP_CTRL_Q_H3K36me3_2C4_GB_f = list(
DN5_Q_H3K36me3_2C4 = DN5_Q_H3K36me3_2C4,
CTRL60_65_Q_H3K36me3_2C4 = CTRL5_Q_H3K36me3_2C4,
delta_UP5_Q_H3K36me3_2C4 = UP5_Q_H3K36me3_2C4
)
Boxplot_wilcoxListFilter_REF(quantifWT = Q_WT3_Rad51_N1, quantifKD = Q_SEA4_Rad51_N1, cond1 = "Q_WT3_Rad51_N1", cond2="Q_SEA4_Rad51_N1", filterGNList = LIST_5_UP_DN_Q_H3K36me3_2C4_GB_f,
effMin =500,  SampleNorm = c(F, "NULL"),YLIM =NULL, bxplt_color = c("#285bad", "#eb3434"), outlierTH = 0.01, logTrans=T,
outdir = outfig, readQuantif = "Q_WT3_Rad51_N1", Cond = "Q_SEA4_Rad51_N1", select = "LIST_5_UP_DN_Q_H3K36me3_2C4_GB_f", info = NULL)
Boxplot_wilcoxListFilter_REF(quantifWT = Q_WT3_Rad51_N1, quantifKD = Q_SEA4_Rad51_N1, cond1 = "Q_WT3_Rad51_N1", cond2="Q_SEA4_Rad51_N1", filterGNList = LIST_1_UP_DN_Q_H3K36me3_2C4_GB_f,
effMin =500,  SampleNorm = c(F, "NULL"),YLIM =NULL, bxplt_color = c("#285bad", "#eb3434"), outlierTH = 0.01, logTrans=T,
outdir = outfig, readQuantif = "Q_WT3_Rad51_N1", Cond = "Q_SEA4_Rad51_N1", select = "LIST_1_UP_DN_Q_H3K36me3_2C4_GB_f", info = NULL)
Boxplot_wilcoxListFilter_REF(quantifWT = Q_WT3_Rad51_N1, quantifKD = Q_SEA4_Rad51_N1, cond1 = "Q_WT3_Rad51_N1", cond2="Q_SEA4_Rad51_N1", filterGNList = LIST_5_UP_CTRL_Q_H3K36me3_2C4_GB_f,
effMin =500,  SampleNorm = c(F, "NULL"),YLIM =NULL, bxplt_color = c("#285bad", "#eb3434"), outlierTH = 0.01, logTrans=T,
outdir = outfig, readQuantif = "Q_WT3_Rad51_N1", Cond = "Q_SEA4_Rad51_N1", select = "LIST_5_UP_CTRL_Q_H3K36me3_2C4_GB_f", info = NULL)
# LUC KD
Boxplot_wilcoxListFilter_REF(quantifWT = Q_WT3_Rad51_L1, quantifKD = Q_SEA4_Rad51_L1, cond1 = "Q_WT3_Rad51_L1", cond2="Q_SEA4_Rad51_L1", filterGNList = LIST_5_UP_DN_Q_H3K36me3_2C4_GB_f,
effMin =500,  SampleNorm = c(F, "NULL"),YLIM =NULL, bxplt_color = c("#285bad", "#eb3434"), outlierTH = 0.01, logTrans=T,
outdir = outfig, readQuantif = "Q_WT3_Rad51_L1", Cond = "Q_SEA4_Rad51_L1", select = "LIST_5_UP_DN_Q_H3K36me3_2C4_GB_f", info = NULL)
Boxplot_wilcoxListFilter_REF(quantifWT = Q_WT3_Rad51_L1, quantifKD = Q_SEA4_Rad51_L1, cond1 = "Q_WT3_Rad51_L1", cond2="Q_SEA4_Rad51_L1", filterGNList = LIST_1_UP_DN_Q_H3K36me3_2C4_GB_f,
effMin =500,  SampleNorm = c(F, "NULL"),YLIM =NULL, bxplt_color = c("#285bad", "#eb3434"), outlierTH = 0.01, logTrans=T,
outdir = outfig, readQuantif = "Q_WT3_Rad51_L1", Cond = "Q_SEA4_Rad51_L1", select = "LIST_1_UP_DN_Q_H3K36me3_2C4_GB_f", info = NULL)
Boxplot_wilcoxListFilter_REF(quantifWT = Q_WT3_Rad51_L1, quantifKD = Q_SEA4_Rad51_L1, cond1 = "Q_WT3_Rad51_L1", cond2="Q_SEA4_Rad51_L1", filterGNList = LIST_5_UP_CTRL_Q_H3K36me3_2C4_GB_f,
effMin =500,  SampleNorm = c(F, "NULL"),YLIM =NULL, bxplt_color = c("#285bad", "#eb3434"), outlierTH = 0.01, logTrans=T,
outdir = outfig, readQuantif = "Q_WT3_Rad51_L1", Cond = "Q_SEA4_Rad51_L1", select = "LIST_5_UP_CTRL_Q_H3K36me3_2C4_GB_f", info = NULL)
Boxplot_wilcoxListFilter_REF(quantifWT = Q_WT3_Rad51_N2, quantifKD = Q_SEA4_Rad51_N2, cond1 = "Q_WT3_Rad51_N2", cond2="Q_SEA4_Rad51_N2", filterGNList = LIST_5_UP_DN_Q_H3K36me3_2C4_GB_f,
effMin =500,  SampleNorm = c(F, "NULL"),YLIM =NULL, bxplt_color = c("#285bad", "#eb3434"), outlierTH = 0.01, logTrans=T,
outdir = outfig, readQuantif = "Q_WT3_Rad51_N2", Cond = "Q_SEA4_Rad51_N2", select = "LIST_5_UP_DN_Q_H3K36me3_2C4_GB_f", info = NULL)
Boxplot_wilcoxListFilter_REF(quantifWT = Q_WT3_Rad51_N2, quantifKD = Q_SEA4_Rad51_N2, cond1 = "Q_WT3_Rad51_N2", cond2="Q_SEA4_Rad51_N2", filterGNList = LIST_1_UP_DN_Q_H3K36me3_2C4_GB_f,
effMin =500,  SampleNorm = c(F, "NULL"),YLIM =NULL, bxplt_color = c("#285bad", "#eb3434"), outlierTH = 0.01, logTrans=T,
outdir = outfig, readQuantif = "Q_WT3_Rad51_N2", Cond = "Q_SEA4_Rad51_N2", select = "LIST_1_UP_DN_Q_H3K36me3_2C4_GB_f", info = NULL)
Boxplot_wilcoxListFilter_REF(quantifWT = Q_WT3_Rad51_N2, quantifKD = Q_SEA4_Rad51_N2, cond1 = "Q_WT3_Rad51_N2", cond2="Q_SEA4_Rad51_N2", filterGNList = LIST_5_UP_CTRL_Q_H3K36me3_2C4_GB_f,
effMin =500,  SampleNorm = c(F, "NULL"),YLIM =NULL, bxplt_color = c("#285bad", "#eb3434"), outlierTH = 0.01, logTrans=T,
outdir = outfig, readQuantif = "Q_WT3_Rad51_N2", Cond = "Q_SEA4_Rad51_N2", select = "LIST_5_UP_CTRL_Q_H3K36me3_2C4_GB_f", info = NULL)
# LUC KD
Boxplot_wilcoxListFilter_REF(quantifWT = Q_WT3_Rad51_L1, quantifKD = Q_SEA4_Rad51_L1, cond1 = "Q_WT3_Rad51_L1", cond2="Q_SEA4_Rad51_L1", filterGNList = LIST_5_UP_DN_Q_H3K36me3_2C4_GB_f,
effMin =500,  SampleNorm = c(F, "NULL"),YLIM =NULL, bxplt_color = c("#285bad", "#eb3434"), outlierTH = 0.01, logTrans=T,
outdir = outfig, readQuantif = "Q_WT3_Rad51_L1", Cond = "Q_SEA4_Rad51_L1", select = "LIST_5_UP_DN_Q_H3K36me3_2C4_GB_f", info = NULL)
Boxplot_wilcoxListFilter_REF(quantifWT = Q_WT3_Rad51_L1, quantifKD = Q_SEA4_Rad51_L1, cond1 = "Q_WT3_Rad51_L1", cond2="Q_SEA4_Rad51_L1", filterGNList = LIST_1_UP_DN_Q_H3K36me3_2C4_GB_f,
effMin =500,  SampleNorm = c(F, "NULL"),YLIM =NULL, bxplt_color = c("#285bad", "#eb3434"), outlierTH = 0.01, logTrans=T,
outdir = outfig, readQuantif = "Q_WT3_Rad51_L1", Cond = "Q_SEA4_Rad51_L1", select = "LIST_1_UP_DN_Q_H3K36me3_2C4_GB_f", info = NULL)
Boxplot_wilcoxListFilter_REF(quantifWT = Q_WT3_Rad51_L1, quantifKD = Q_SEA4_Rad51_L1, cond1 = "Q_WT3_Rad51_L1", cond2="Q_SEA4_Rad51_L1", filterGNList = LIST_5_UP_CTRL_Q_H3K36me3_2C4_GB_f,
effMin =500,  SampleNorm = c(F, "NULL"),YLIM =NULL, bxplt_color = c("#285bad", "#eb3434"), outlierTH = 0.01, logTrans=T,
outdir = outfig, readQuantif = "Q_WT3_Rad51_L1", Cond = "Q_SEA4_Rad51_L1", select = "LIST_5_UP_CTRL_Q_H3K36me3_2C4_GB_f", info = NULL)
outfig = paste0(workdir,"FIGURES/BOXPLOT/BOXPLOT_RAD51_SEA4_WT3/")
Boxplot_wilcoxListFilter_REF(quantifWT = Q_WT3_Rad51_N1, quantifKD = Q_SEA4_Rad51_N1, cond1 = "Q_WT3_Rad51_N1", cond2="Q_SEA4_Rad51_N1", filterGNList = LIST_5_UP_DN_Q_H3K36me3_2C4_GB_f,
effMin =500,  SampleNorm = c(F, "NULL"),YLIM =NULL, bxplt_color = c("#285bad", "#eb3434"), outlierTH = 0.01, logTrans=T,
outdir = outfig, readQuantif = "Q_WT3_Rad51_N1", Cond = "Q_SEA4_Rad51_N1", select = "LIST_5_UP_DN_Q_H3K36me3_2C4_GB_f", info = NULL)
Boxplot_wilcoxListFilter_REF(quantifWT = Q_WT3_Rad51_N1, quantifKD = Q_SEA4_Rad51_N1, cond1 = "Q_WT3_Rad51_N1", cond2="Q_SEA4_Rad51_N1", filterGNList = LIST_1_UP_DN_Q_H3K36me3_2C4_GB_f,
effMin =500,  SampleNorm = c(F, "NULL"),YLIM =NULL, bxplt_color = c("#285bad", "#eb3434"), outlierTH = 0.01, logTrans=T,
outdir = outfig, readQuantif = "Q_WT3_Rad51_N1", Cond = "Q_SEA4_Rad51_N1", select = "LIST_1_UP_DN_Q_H3K36me3_2C4_GB_f", info = NULL)
Boxplot_wilcoxListFilter_REF(quantifWT = Q_WT3_Rad51_N1, quantifKD = Q_SEA4_Rad51_N1, cond1 = "Q_WT3_Rad51_N1", cond2="Q_SEA4_Rad51_N1", filterGNList = LIST_5_UP_CTRL_Q_H3K36me3_2C4_GB_f,
effMin =500,  SampleNorm = c(F, "NULL"),YLIM =NULL, bxplt_color = c("#285bad", "#eb3434"), outlierTH = 0.01, logTrans=T,
outdir = outfig, readQuantif = "Q_WT3_Rad51_N1", Cond = "Q_SEA4_Rad51_N1", select = "LIST_5_UP_CTRL_Q_H3K36me3_2C4_GB_f", info = NULL)
# LUC KD
Boxplot_wilcoxListFilter_REF(quantifWT = Q_WT3_Rad51_L1, quantifKD = Q_SEA4_Rad51_L1, cond1 = "Q_WT3_Rad51_L1", cond2="Q_SEA4_Rad51_L1", filterGNList = LIST_5_UP_DN_Q_H3K36me3_2C4_GB_f,
effMin =500,  SampleNorm = c(F, "NULL"),YLIM =NULL, bxplt_color = c("#285bad", "#eb3434"), outlierTH = 0.01, logTrans=T,
outdir = outfig, readQuantif = "Q_WT3_Rad51_L1", Cond = "Q_SEA4_Rad51_L1", select = "LIST_5_UP_DN_Q_H3K36me3_2C4_GB_f", info = NULL)
Boxplot_wilcoxListFilter_REF(quantifWT = Q_WT3_Rad51_L1, quantifKD = Q_SEA4_Rad51_L1, cond1 = "Q_WT3_Rad51_L1", cond2="Q_SEA4_Rad51_L1", filterGNList = LIST_1_UP_DN_Q_H3K36me3_2C4_GB_f,
effMin =500,  SampleNorm = c(F, "NULL"),YLIM =NULL, bxplt_color = c("#285bad", "#eb3434"), outlierTH = 0.01, logTrans=T,
outdir = outfig, readQuantif = "Q_WT3_Rad51_L1", Cond = "Q_SEA4_Rad51_L1", select = "LIST_1_UP_DN_Q_H3K36me3_2C4_GB_f", info = NULL)
Boxplot_wilcoxListFilter_REF(quantifWT = Q_WT3_Rad51_L1, quantifKD = Q_SEA4_Rad51_L1, cond1 = "Q_WT3_Rad51_L1", cond2="Q_SEA4_Rad51_L1", filterGNList = LIST_5_UP_CTRL_Q_H3K36me3_2C4_GB_f,
effMin =500,  SampleNorm = c(F, "NULL"),YLIM =NULL, bxplt_color = c("#285bad", "#eb3434"), outlierTH = 0.01, logTrans=T,
outdir = outfig, readQuantif = "Q_WT3_Rad51_L1", Cond = "Q_SEA4_Rad51_L1", select = "LIST_5_UP_CTRL_Q_H3K36me3_2C4_GB_f", info = NULL)
Boxplot_wilcoxListFilter_REF(quantifWT = Q_WT3_Rad51_N2, quantifKD = Q_SEA4_Rad51_N2, cond1 = "Q_WT3_Rad51_N2", cond2="Q_SEA4_Rad51_N2", filterGNList = LIST_5_UP_DN_Q_H3K36me3_2C4_GB_f,
effMin =500,  SampleNorm = c(F, "NULL"),YLIM =NULL, bxplt_color = c("#285bad", "#eb3434"), outlierTH = 0.01, logTrans=T,
outdir = outfig, readQuantif = "Q_WT3_Rad51_N2", Cond = "Q_SEA4_Rad51_N2", select = "LIST_5_UP_DN_Q_H3K36me3_2C4_GB_f", info = NULL)
Boxplot_wilcoxListFilter_REF(quantifWT = Q_WT3_Rad51_N2, quantifKD = Q_SEA4_Rad51_N2, cond1 = "Q_WT3_Rad51_N2", cond2="Q_SEA4_Rad51_N2", filterGNList = LIST_1_UP_DN_Q_H3K36me3_2C4_GB_f,
effMin =500,  SampleNorm = c(F, "NULL"),YLIM =NULL, bxplt_color = c("#285bad", "#eb3434"), outlierTH = 0.01, logTrans=T,
outdir = outfig, readQuantif = "Q_WT3_Rad51_N2", Cond = "Q_SEA4_Rad51_N2", select = "LIST_1_UP_DN_Q_H3K36me3_2C4_GB_f", info = NULL)
Boxplot_wilcoxListFilter_REF(quantifWT = Q_WT3_Rad51_N2, quantifKD = Q_SEA4_Rad51_N2, cond1 = "Q_WT3_Rad51_N2", cond2="Q_SEA4_Rad51_N2", filterGNList = LIST_5_UP_CTRL_Q_H3K36me3_2C4_GB_f,
effMin =500,  SampleNorm = c(F, "NULL"),YLIM =NULL, bxplt_color = c("#285bad", "#eb3434"), outlierTH = 0.01, logTrans=T,
outdir = outfig, readQuantif = "Q_WT3_Rad51_N2", Cond = "Q_SEA4_Rad51_N2", select = "LIST_5_UP_CTRL_Q_H3K36me3_2C4_GB_f", info = NULL)
# LUC KD
Boxplot_wilcoxListFilter_REF(quantifWT = Q_WT3_Rad51_L1, quantifKD = Q_SEA4_Rad51_L1, cond1 = "Q_WT3_Rad51_L1", cond2="Q_SEA4_Rad51_L1", filterGNList = LIST_5_UP_DN_Q_H3K36me3_2C4_GB_f,
effMin =500,  SampleNorm = c(F, "NULL"),YLIM =NULL, bxplt_color = c("#285bad", "#eb3434"), outlierTH = 0.01, logTrans=T,
outdir = outfig, readQuantif = "Q_WT3_Rad51_L1", Cond = "Q_SEA4_Rad51_L1", select = "LIST_5_UP_DN_Q_H3K36me3_2C4_GB_f", info = NULL)
Boxplot_wilcoxListFilter_REF(quantifWT = Q_WT3_Rad51_L1, quantifKD = Q_SEA4_Rad51_L1, cond1 = "Q_WT3_Rad51_L1", cond2="Q_SEA4_Rad51_L1", filterGNList = LIST_1_UP_DN_Q_H3K36me3_2C4_GB_f,
effMin =500,  SampleNorm = c(F, "NULL"),YLIM =NULL, bxplt_color = c("#285bad", "#eb3434"), outlierTH = 0.01, logTrans=T,
outdir = outfig, readQuantif = "Q_WT3_Rad51_L1", Cond = "Q_SEA4_Rad51_L1", select = "LIST_1_UP_DN_Q_H3K36me3_2C4_GB_f", info = NULL)
Boxplot_wilcoxListFilter_REF(quantifWT = Q_WT3_Rad51_L1, quantifKD = Q_SEA4_Rad51_L1, cond1 = "Q_WT3_Rad51_L1", cond2="Q_SEA4_Rad51_L1", filterGNList = LIST_5_UP_CTRL_Q_H3K36me3_2C4_GB_f,
effMin =500,  SampleNorm = c(F, "NULL"),YLIM =NULL, bxplt_color = c("#285bad", "#eb3434"), outlierTH = 0.01, logTrans=T,
outdir = outfig, readQuantif = "Q_WT3_Rad51_L1", Cond = "Q_SEA4_Rad51_L1", select = "LIST_5_UP_CTRL_Q_H3K36me3_2C4_GB_f", info = NULL)
